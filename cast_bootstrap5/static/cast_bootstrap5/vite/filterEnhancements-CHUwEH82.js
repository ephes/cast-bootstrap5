const E="[data-cast-facet-group]",w=".cast-date-facet-item",h="cast-facet-item-hidden";function v(t){const e=[];return t instanceof Element&&t.matches(E)&&e.push(t),e.push(...Array.from(t.querySelectorAll(E))),e}function F(t){return!!t.querySelector("a.selected")}function O(t){var n;const e=(n=t.getAttribute("data-limit"))!=null?n:"",a=Number.parseInt(e,10);return Number.isFinite(a)?a:0}function b(t,e,a,n){if(t){if(n>0){t.textContent=`${e} (${n} ${a})`;return}t.textContent=e}}function N(t){var o,s,m,f;if(t.dataset.castFacetReady==="true"||t.closest(".cast-search-modal"))return;const e=Array.from(t.querySelectorAll(w)),a=O(t),n=t.querySelector("[data-cast-facet-toggle]"),r=(o=n==null?void 0:n.querySelector("[data-cast-facet-more]"))!=null?o:null,c=(m=(s=n==null?void 0:n.dataset.castMoreLabel)!=null?s:r==null?void 0:r.textContent)!=null?m:"Show all",i=(f=n==null?void 0:n.dataset.castCountLabel)!=null?f:"more";if(!a||e.length<=a){n&&(n.hidden=!0),t.dataset.castFacetReady="true";return}const u=()=>{e.forEach((p,S)=>{const L=S<a||F(p);p.classList.toggle(h,!L)});const l=e.filter(p=>p.classList.contains(h)).length;delete t.dataset.expanded,n&&n.setAttribute("aria-expanded","false"),b(r,c,i,l)},d=()=>{e.forEach(l=>{l.classList.remove(h)}),t.dataset.expanded="true",n&&n.setAttribute("aria-expanded","true"),b(r,c,i,0)};u(),n&&(n.hidden=!1,n.addEventListener("click",()=>{t.dataset.expanded==="true"?u():d()})),t.dataset.castFacetReady="true"}function q(t=document){v(t).forEach(e=>{N(e)})}const y="#div_id_o";function _(t){const e=[];return t instanceof Element&&t.matches(y)&&e.push(t),e.push(...Array.from(t.querySelectorAll(y))),e}function R(t){var u;if(t.dataset.castOrderingEnhanced==="true"||t.closest(".cast-search-modal"))return;const e=t.querySelector('select[name="o"]');if(!e)return;const a=t.querySelector('label[for="id_o"]');a&&!a.id&&(a.id="ordering-label");const n=document.createElement("div");n.className="dropdown";const r=document.createElement("button");r.type="button",r.className="btn btn-outline-secondary dropdown-toggle w-100 text-start",r.setAttribute("data-bs-toggle","dropdown"),r.setAttribute("aria-expanded","false"),a!=null&&a.id&&r.setAttribute("aria-labelledby",a.id);const c=document.createElement("ul");c.className="dropdown-menu w-100";const i=Array.from(e.options);i.forEach(d=>{const o=document.createElement("li"),s=document.createElement("button");s.type="button",s.className="dropdown-item",s.textContent=d.textContent,s.setAttribute("data-order-value",d.value),d.selected&&(s.classList.add("active"),r.textContent=d.textContent),o.appendChild(s),c.appendChild(o)}),r.textContent||(r.textContent=i.length>0?i[0].textContent:"Ordering"),n.appendChild(r),n.appendChild(c),(u=e.parentNode)==null||u.insertBefore(n,e),c.addEventListener("click",d=>{var f;const o=d.target;if(!(o instanceof Element))return;const s=o.closest("[data-order-value]");if(!s)return;const m=(f=s.getAttribute("data-order-value"))!=null?f:"";e.value=m,r.textContent=s.textContent,c.querySelectorAll(".dropdown-item").forEach(l=>{l.classList.toggle("active",l===s)})}),e.setAttribute("tabindex","-1"),e.setAttribute("aria-hidden","true"),e.style.display="none",t.dataset.castOrderingEnhanced="true"}function T(t=document){_(t).forEach(e=>{R(e)})}let C=!1,x=null;function A(t=document){q(t),T(t)}function g(){if(typeof document=="undefined")return;const t=()=>{A(document)};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t,{once:!0}):t(),C||(x=e=>{const a=e.detail,n=a==null?void 0:a.target;n instanceof Element&&A(n)},document.body.addEventListener("htmx:afterSwap",x),C=!0)}typeof document!="undefined"&&g();
